<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³µë¶ˆë³µ ì¦‰í¥ ì—¬í–‰! ëœë¤ ì¢Œí‘œ ìƒì„±ê¸°</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; margin: 0; padding: 20px; }
        .header { text-align: center; margin-bottom: 20px; }
        h1 { color: #1e3a8a; font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.1); }
        
        #map { width: 100%; max-width: 800px; height: 600px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); border: 5px solid white; }
        
        .ui-panel { margin-top: 20px; text-align: center; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        .result-box { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; color: #d32f2f; min-height: 1.5em; }
        
        button { background-color: #1e3a8a; color: white; border: none; padding: 15px 30px; font-size: 1.2rem; font-weight: bold; border-radius: 50px; cursor: pointer; transition: 0.3s; width: 100%; }
        button:hover { background-color: #2563eb; transform: scale(1.05); }
        button:active { transform: scale(0.95); }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ² ë³µë¶ˆë³µ ì¦‰í¥ ì—¬í–‰!</h1>
    <p>ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì „êµ­ ì–´ë””ë“  ëœë¤ìœ¼ë¡œ ëª©ì ì§€ë¥¼ ì •í•´ì¤ë‹ˆë‹¤.</p>
</div>

<div id="map"></div>

<div class="ui-panel">
    <div id="result" class="result-box">ì¤€ë¹„ë˜ì…¨ë‚˜ìš”?</div>
    <button onclick="pickRandomLocation()">ğŸ“ ëª©ì ì§€ ë½‘ê¸°!</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. ì§€ë„ ì´ˆê¸°í™” (ëŒ€í•œë¯¼êµ­ ì¤‘ì‹¬ë¶€)
    var map = L.map('map').setView([36.3504, 127.3845], 7);

    // 2. ì§€ë„ ë°°ê²½ ì„¤ì • (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    var currentMarker = null;

    // 3. ë‚¨í•œ ë²”ìœ„ (ìœ„ë„: 34.0 ~ 38.3, ê²½ë„: 126.0 ~ 129.5)
    function pickRandomLocation() {
        const minLat = 34.2, maxLat = 38.0;
        const minLng = 126.2, maxLng = 129.3;

        const randomLat = (Math.random() * (maxLat - minLat) + minLat).toFixed(6);
        const randomLng = (Math.random() * (maxLng - minLng) + minLng).toFixed(6);

        // ì´ì „ ë§ˆì»¤ ì œê±°
        if (currentMarker) {
            map.removeLayer(currentMarker);
        }

        // ìƒˆ ë§ˆì»¤ ì¶”ê°€ ë° ì´ë™
        currentMarker = L.marker([randomLat, randomLng]).addTo(map);
        map.flyTo([randomLat, randomLng], 12); // í•´ë‹¹ ìœ„ì¹˜ë¡œ ì¤Œì¸

        // ê²°ê³¼ í…ìŠ¤íŠ¸ í‘œì‹œ
        document.getElementById('result').innerText = `ê²°ì •ëœ ì¢Œí‘œ: ${randomLat}, ${randomLng}`;
        
        // ì—­ì§€ì˜¤ì½”ë”© (ìœ„ì¹˜ ì´ë¦„ ì°¾ê¸°) - ì˜¤í”ˆ API ì‚¬ìš©
        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${randomLat}&lon=${randomLng}`)
            .then(response => response.json())
            .then(data => {
                const address = data.display_name.split(',').reverse().slice(1, 4).join(' ');
                document.getElementById('result').innerHTML = `ğŸ“ ëª©ì ì§€: <br>${address || "ì•Œ ìˆ˜ ì—†ëŠ” ì§€ì—­ (ì‚°ê°„/ë°”ë‹¤)"}`;
                currentMarker.bindPopup(`<b>ì—¬ê¸°ë¡œ ê°€ì„¸ìš”!</b><br>${address}`).openPopup();
            })
            .catch(() => {
                document.getElementById('result').innerText = `ì¢Œí‘œ: ${randomLat}, ${randomLng}`;
            });
    }
</script>

</body>
</html>
